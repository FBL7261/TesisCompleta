<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="8dp">

    <!-- Toggle para mostrar/ocultar la configuración del servidor -->
    <Button
        android:id="@+id/btnToggleConfig"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="Servidor ▸"
        android:padding="8dp" />

    <!-- Panel plegable de configuración (inicia oculto) -->
    <LinearLayout
        android:id="@+id/panelConfig"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:visibility="gone"
        android:paddingTop="6dp"
        android:gravity="center_vertical">

        <EditText
            android:id="@+id/edtBaseUrl"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:hint="http://192.168.1.4:5000/"
            android:inputType="textUri"
            android:singleLine="true" />

        <Button
            android:id="@+id/btnGuardarUrl"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Guardar"
            android:layout_marginStart="8dp" />
    </LinearLayout>

    <!-- Área de previsualización reducida con overlay -->
    <FrameLayout
        android:id="@+id/framePreview"
        android:layout_width="match_parent"
        android:layout_height="320dp"
        android:layout_marginTop="8dp">

        <!-- Preview de la CÁMARA -->
        <androidx.camera.view.PreviewView
            android:id="@+id/previewView"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:scaleType="fitCenter" />

        <!-- Preview de la GALERÍA (inicia oculto) -->
        <ImageView
            android:id="@+id/galleryPreview"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:adjustViewBounds="true"
            android:scaleType="fitCenter"
            android:visibility="gone" />

        <!-- Overlay con el rectángulo guía -->
        <com.jimrc.apptesis.ViewfinderOverlay
            android:id="@+id/overlay"
            android:layout_width="match_parent"
            android:layout_height="match_parent" />
    </FrameLayout>

    <!-- Botones de acción -->
    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:weightSum="2"
        android:layout_marginTop="8dp">

        <Button
            android:id="@+id/btnGaleria"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="Galería" />

        <Button
            android:id="@+id/btnCapture"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_weight="1"
            android:text="Capturar" />
    </LinearLayout>

    <!-- Estado de procesamiento -->
    <LinearLayout
        android:id="@+id/panelEstado"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal"
        android:gravity="center_vertical"
        android:paddingTop="6dp"
        android:visibility="gone">

        <ProgressBar
            android:id="@+id/progress"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            style="?android:attr/progressBarStyleSmall"
            android:indeterminate="true" />

        <TextView
            android:id="@+id/txtEstado"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Procesando imagen..."
            android:layout_marginStart="8dp" />
    </LinearLayout>

</LinearLayout>
